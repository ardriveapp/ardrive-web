#!/bin/bash

# Store the JSON value in a variable to handle it more cleanly
JSON_VALUE='{"d":"boMCYRnKbWMZ2iKZtdWlNtMzQqk8rw6gNqT6l_l5VgdXnQ-dtxPhrgwJ0sGi8k5gyDTaMY-5ICjF4YNiUL-ugQjRccT0YritisWuTHt5hes-FuTiZXjjxMS3cuOMiGIZYz2R10RK3SR5vmejn85A5PULF4n8jngiftsgQtLXRg3287jUZYcFg7k7c4sJPxS2FbtiZu5JfnWUJ0SXALRAWTnV4M6bTZ7KY42MFyk5cNGc8Z-Xj9greDtS9BpalyRGxH1VI7jC8ZGcwUGpURd4qBREMu4qsNPxg44Ne9dS4ccvXY27ZXXnbzaDIkU0IrP7hNzUmmkhNNht-5pmUgdqu1C5SR201bPjfRv05QEnqvQBCDVLiPiaMy72pGA76hWcJeK3YY05kNaoyjge1M5auTK_HyvyVb2-G1Q1zUMBKvAmQk9DCpxOP0KZaQGAbpPGKFjciZOFj7c-UnDcc1f-cQ-XL_fZEmzW3lA1WvkuBMFnkVI-hOieOj77wRD_mtnkKVHP1w3La5KLVSDfRKTmXvh1CB201fzToCLoPxFX64CcluTvY4WUsXT15ioQWzWf47NGtQxrL5MWxIltfxyAvfYHTJbwqRz60GnmRQPf7HOroVWoCIOntUN98veWA79826qgG-tN36_ixosZTMRTWILAHz1td43ZYUgyRS4_MsE","dp":"yFGRrngGu1Bx3ym9fa9UwzsBaWnT1YDuJAfsW6t7Vg3pBT33B25RYtFso5JxuHlM221GkANetiYdFDeQgvxn40vrwF0ArwGbCTNPkz4nL6QQuJqzLS0sHaUnN9aeKu0_OTgJunJaUzpNHC-Urk2_dWXT9RUtEiuOWYMbUUZE9Xro-427_Lmi5u1p7YmHzf94vcX_Huuhzti-j7OmbPNm1D9JvOuFPS127PlqbSNNxBDOk4WTnpTfaAThNbwRcRuaLmRcyw-x3TtFJ_GgrixWlpOn0HvCiBYXjYv97UMQb7DgHXGukZfn8SEK_frBd4Ywi5jLmVsdh8b_jiqrh6NzFQ","dq":"a_FulDO2kAb414eJAH_PuM2LDM358kzH4WJuu7WmcTUy6euipYpP8kEEdKa2TEPXTcLn1MW9NffU1t8jdEuIjP1_QOxDwFsIWtjvZOyi3lFDmFTSBYCTkKMEfnUdghm7RX_4hk2EeolzUgbms-j2buiJnEaSyeyVKYpMLh4C5N0loRaPEApx2dx7fZKxlvW40_9hu7xTjBCOD401Jpo5fHGbjOTOFaEYAdsIzHzGNYcVzCrs0DF47h7Fc6GKeNcgbyKjdmZ0FloA0u0SqtWOuH0e1mMzi0tYlFU7lvBbqJCg7Tw68Wb4NJR-GoyKesV5wvIkLFGIIeVdOTBuu_vaQQ","e":"AQAB","kty":"RSA","n":"uJJ0n3kA1Gdi_VCpQqT_ZyIlncCilDGTyfadE7Ppw1uUuQOr6SaFukHQFIisx7Gg2GxdkbtH-LSfWyKGDhrSVkSzS5AkKqxxYfwXtYi6pXqFGkWUcsp1n-sZQhgb2AMknwVorQDL-WtnM6Bl7Tknh69P4hM7tdBoUxLV3jM2s-L2QEx2JrJBGdOhuIouua89tNqG-5F1--xJ4f6huWfroPkoNG3-nk-XocsuAvUYixxTUahGCZn8qZAR2IaKoXk6QDjzozCHjpCqDyAP_RUYycC4Ldb2O81-Z6ZXbvBIMC-16zVzT-n0cmQDtfE4KFhL8cEDpgG-9Ly-USkWXe4hHSzBYJlW453-jj6g2W6qx-9WDT41RHamjGLRdgxHmoAtA1fkNfwVnjFtLOB48POpYwy0ehANW0GVBC_9QLj71lEgHgXU3V2VJDcjTkn7jgx166JHbpBqt3yuX72HoU-DYGDSWhU3zxQUtsY7gQ6rlUdNG0vpJQM4sg7v05g3RzYrFSqkW9fb6aTXZHqqBktTgThqlyvky-NOlm_zr93TTnKpzzGNIrkOyT-GbtOl9hoeaYWwcqiSvHW9Cpj1pDUefhmWtHx-28UDRmvAOFd15xI7ptPcMA0U6JLQt1zxe9XGfRPnXeTDhYIYtmWMDjZRoeimankehknBQSlXT55BFBc","p":"4erWLhivIvz4TVa9dFhG0HOwCSRl7-f6-2xQ_IPATiOVGsRUn9Uc7RvlknzKv2Qb4V2eSTL-yVHjS85Pi69S9MCUo18sdF1Qh3dm5gL2WNFPJTEhzUK1EGFcwB37oLxh_HIurm0fzOsN0l9PNlnQww63KU4lu8OCAue3hlAyPNZktWg7tll4pLEC30Cnk_EswDELX9DHGRmLSUr-N-4B7ZGH9G2h7lQrV4XYcTm1tskQRTw_lDGzhJ2qHaLXMIMVM_axOaV0za67ST4a6nd3zI4lJ8qw1uDx7FvgO-rTlYT1Ft4KA7zi_IdMSssKa3-FtwtXG57QE_epgF5sVojQ7Q","q":"0SY5r13Plt5m6-aS1La82yppy-AU1LKyHtY45thL2-FFvtauBqMo56qtVVZN42BrqvIduhu_DyzjSkNJiDoaV7hnKb6ki7y8Wd0zkkFznCA59Qs4JXBTcgCk8iWCef_66HiZHVnvl3orzZRpEsR_kz8n_6Nadqu1kkgYpX8J86X7oIveYoYwtrky0OEdIu5wc7XPhilJ7tXQSdVoxzNYkpyjtmAdBXFzTp2B35aLZoyPCmt7PYEor4dK-j2Azh61NYxfIUF41MD2aPm-yc-DIj01rDdLrK0y28Z6ZonzHDAGw-oFrHUNh3upKnb0rBRB8NTxdOb3bZMBcTVXxL4Mkw","qi":"WdBCzzpGjI2gBWC5xLfo3-QUvNO-ilnDZ2Sw8W8IvmlnocsKRnjvi4mrmxabFuRwSog2D9XHzPIsLHeScgD0HOmV4uTYzExEkwXjKmUVUhVdHPbWGEHV6lh50frbfp8kiNP-8P7yF1firrMtFQaxwxXJhPm64SCxkQ9oR1ZRMgG_JVbb9ksHvIFVKsvRdhVpfz6n2i729XTXhK0dhOyHCYwRz9113P-aitA2CrmJ3UGVY9NDUl5v_c_0siOj_sEYxHn9cHdv2wZTBK7UGmOyKsTngJsS7kyd4qYIEuBBwHn2rU-y-7Rmyw0qtshMjT1MimGl29ETb65w0ORjtk61yg"}'

# Run the Flutter drive command with the necessary parameters
fvm flutter drive \
    --driver=test_driver/integration_test.dart \
    --target=integration_test/app_test.dart \
    -d web-server \
    --browser-name chrome \
    --no-headless \
    --dart-define=integration-test=true \
    --dart-define=WALLET_KEY_FILE="$JSON_VALUE"

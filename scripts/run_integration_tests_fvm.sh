#!/bin/bash

# Store the JSON value in a variable to handle it more cleanly
JSON_VALUE='{"d":"D01JC4GG0BzsjsiuxSRnv43pIhAXlTgb-ahnkS65A5MHn_lutLGhEcOm63qqKw5INu_xBv7wkmrmL552HjiT4yA0BQ0IW3WoYVKPwPA7q7oS10mAd9gCpxplTa3Xio7m8OFM7q_kQ9H50CUVL6dELmx_PVIZN_c3H92cD3vEU89Wyew2Qc8M-rOJVUg_E1dSi3uiNDCjRe2q7qndBC_gD_NBd4ZIlsz1OfWdaVEh8QvN0GDf58RY5W9OEH17zQWqnUQYcT5yv70OYhb364aV7WCAjl641r37Ldk4MZ5LbsYt5HLrzD2GUcrM9f4e4PHXsJWous6T37zYKM-hovno78Ay6zdg0y_Hbfvy7Z2FCbJjdCQeeYZgVpE93wcFkyWVHUBK0vTTjcy6G6iKOHB6ePbsFvGshta_xnh1fopfo7_4yoofIkDniJiL_sWVC5grj7t9w72-7C9h8O58rYtFb7pNKbmE1fF5BTs1vnTeMFM5rNZ1Z2oXZ_6KIaMBGurIIO0qxXw2Gdtx_1-Y89L5rF8fakZYkhQcF8r4PI8ag27q96kempOpsPjM1BxpYA4GCfAX2WbjGmQbjbKBtoBhNtAYrtyThRcaNdUitOB90-EVILbE0SZO6zjuqjs170gqS6b7Eh9ld0vu2UsnuoBA9WtG0FnRDIM-RgDX3wCFotE","dp":"xoIwsL6VDrmpns26AtJ9hX_W4J3qkko2ruJqtMNJbFQCEc_CiF3YWIOJv58vEuhBH_VxEHO_BRNcFGwS9NzinC12veCl0efaEiFpDrN8RhVhGyLdFZh4rR9KwmvGo70wUmb9hs-jHSgt_cB3HCnf0H4pG-tQUVNmPu_5W7ZzeUTvmh5yGh61QLs16JJNWCN_iMPRAndZzZdgxy9ftbxoNzw6iemaTcpShJDW0sRuP5kycXt5wH5LuaIvM1IgO7oLm7jAqpAm0CmnZppkRoycI1TVSLBrEF5JQCfos--anMVdi8j7IEoaiRxlws_siI3e7i4_GNeqco-fjDrUspVdCQ","dq":"Tbzxm8n24LajMEOR0ucDBmYO4e-GUYN6xg2P34Qyxpp3UxyoNDmwr9IOf5LeSSqV8eJGcJr3_cdmXCYx3MvH3-DCD_KGnOPr1LLCwhMAyjBXlt5rlnmMqN6BJ4gCnGYWM6N8BKBW5XmkfiNqmrTKXBi989rff_TlfFEca0RXkk4tg7iUS4Tr-FG1mYI53a7Rw8nXnD-DulhoOei_w3SWFxc7AdKRd1NiDLB7kuPJQJTC50wGt38P-78aWb0uIeARorMVjk-YxWBx3pZBw3f6KVF5-RD-FyYiQJd1FU8RXQdjUt0EIoMIT-hok0S-dgPRiFfV3QhIHdDPHKexsCIcmw","e":"AQAB","kty":"RSA","n":"p-VFQIcxUN1a-nBF2oFjY7gyZtRljC4rBV-sEDaciScCvkGEvcvfZpgCXObTiu1TKCqD4EhUEBevMGqJm70O3AtzIbCZSWtFQpnpbzhM-ViHfpQyocW7ePOhinFJhXDT42FTcm1rF_gDLUFVBaJNTil5PedWBZcgZ8BkrlheRdjELecQPqGHTAMWXWpvgLlnzCXJ51lW0JhGIeSkU1tuGUIFhPuBLqeU-eg6lggcjVb_tTJfQuogkFwKcu4N6H16JZNLtFklxGq5t3QxT0TaEVVqixdTFOhhin8Jl_U-k-86ReVaGQA9ALDe51D_vuJpSATbShMPDqVZASXzKw3s9k-HiSWpCIA8dnTbQcRQ6mLCPNhaK944UKL17oe3j3a68SKM0_2E1d4gSRvIyg_-pS3husYxbAkgsV3zse2mELqyQjEM8bT27CWLZwd3rYpYeIutCdr61bb7K5wadcJkDb2lQf1mmzh5kA4DlgUBVGQe3ep8HrzFilb_ooItJcSmSANktJA3fPNLTh1fF2z5ut4xt3ZTu76PdYwN3Nn1Hy6rOiP-r5ffuPylGtbBFMTRl_AkGMEohnHIwUWU82uqtlteZ3rRKKbl250JLyWc8FTfLNx9hVBMoNsYjtNzmiaQPoCHt_-ZbVCk0X4mfspt_brS8sM80Z2JTYmivM_oAf8","p":"0Y14Y8k21fKARJReCOrHF2PaNsnLB7wdUH_mwr7FW6JsM0EqT9dLrifzHVvvwxF2lKnHB3Rb9SxYSq-JDH1NmLTR3hgOKZSENT2bJck19m6Y9a3A2rvmvNk1qpRcLuiKpbRh-2lE0hC2lKE3ZMuJVcgEfrWCfb2_-LPJTfAOHiUCC6UeY3RGvZv3WzE9DwRmABJQ0m674RyMcN6Q7fXKPHX0zRZroSD6HHU0Rarz33R4AVgL03uWML1Sds3JQXIGVS9cMd1ozwCSRTERvTYER6uvWbKRUvVQfRh8HfiQPfOZCEtoAziuWvfxL2HJUOJlKpz0UpSiGKA7XImMNZkAWQ","q":"zRwUAH2Ek-7ESKrxQaZgAhKLR78yNooL6MsjSjJBw07qR7YoeM9qM77jOymQbG6ZTUTmxM3tb4TcYweDcofyrj7974lWk-wtj4BxVmVXVpMsN22Cihi0rM8DmOg0PKZfJUZg8WECS-GN_Re4_YfRbKFWIvJ2CYGt6XSvn964FBhHq2K5k9uCmtby6cRxfirZJBQcoc0QzumBz-EZHmWoShiHuaTyOCMjZzQE268d9uOpl4tPtwILrNa5Vn8eExbn8Uo4BOrvQx4JCfz5OdOOG3kaVp_s9I1LUO7WJ1nuFqlBQJKrg4gaqXb992B5pMVXfhJD2HIVMN8-36gXFaGKFw","qi":"IymVRhthlwJR-oKOxyg6tF173fkEyaca4O9eRoaZjtXjo-FkQhthwghqwJ394RGBU3pk_XwvxmuQs0CvkQyaXWNMIPddThMxv2OMDCCYdpQay-6RJLbDpbzreV54Wtb23qqEFRp98v2aQqbZLG1PJZBu6DlKThFCQLOTG8RXMlZX5QLXnFSgo-HtSRuFmR_dNCp814h_bH-AX6aQJb4lWwlunW80JZ9W-gRTZQyf3zTPGAZSTK1hhFHZm9v2ePBKFUUWmbmwTLLVlrF9g5H8Pdi22VQTgfHen5FNdXQHXxedwEXmAPVk6FWENUzgBzs1Wut-QZUsG2cJWAaaLXtYUw"}'
# Run the Flutter drive command with the necessary parameters
fvm flutter drive \
    --driver=test_driver/integration_test.dart \
    --target=integration_test/app_test.dart \
    -d web-server \
    --browser-name chrome \
    --no-headless \
    --dart-define=integration-test=true \
    --dart-define=WALLET_KEY_FILE="$JSON_VALUE"

#!/bin/bash

# Store the JSON value in a variable to handle it more cleanly
JSON_VALUE='{"d":"WVD72Z_SGBB7UpVlpJmsTYM0fslzsd1L7FR_7yBP9D4AbNexuV2Y1zwhYJ_P46y8jjB7PEbx5BZojCrAX0uGCLPMaLmOwrcJDBZu3DT6O_BC_23n7h8HC01jN7UN6a20t0lSOmlTVFijaiwKE7pyH7lpoC9XVVX7SkryD90pzHifLpKbUoJQUPFv7l0s7ZFKEse9I-KHfSSNn9UUUl1r0mP6NcSaAslMSuPq5m7-Kz0DDXYZrgrSSTesn1mF-Wq1Cugo09DjOpVrkFE1MxviD2HIvmajEIn9T6bxLgCQgm49lwSR0TcwPA-15tZB8jQKTRb7e1grYpFJfk2Jacly2LXFjijjQ_inoTBfFbI34gATuuo_BC_PNrIgoFHzL0iq_xL5f0qmKRIWpgdAtAwb7Dh-IeFcKxK8jGeau6Aq8xGN-S7_Pw1lMveUZ3ntYHBcSqVeafw-lRTsArMAknJXFrvoWL0f45AoqSd6QeDSCwx2Yzw5m9yA9TKDx3Rxw2OaH79WIEph9TW5j0waQlscJZ1yyu50Cb1ncMjis43Zq0LNRTuK_osWnIQ8wsWYDNuKqfIN7OZxSS9C-Y1Xg1DYNinNiyL8sfOwnKsI_bcTdPjxKWTIUENuk3RofR8kPC6t30rQ-mqSILQasd7OYXXKqOxpNQpjQMqY6RsvfS08GfE","dp":"XA3JF6gCnLCr_jy1RjzAl78ilDpvGwRLBU5C9iyyJWDeh5_jO6sCDDiFpshEozNffYM964Db9Zmz8XYCTzkLbncRT5m4SbwdMaLTyVE7lga0J-SPCMN1LqP3WYhraVG1CkFXd3GNmITzYYpOGL1vAZMXqnk6lQT0pIIB4Yh3doFDpVTgP9ThWeHU60cvaOikEzKXPRVs5kl8DyxTgKU2c9tBb84ONKNY17oXrYPDjNmrHOpN5ggKhR22tdG7Hpx2Hj4ziU5pqt9oTSsKQpElgwU03JhEAfkuHQRsb18ZMBPx-VMU9gN1VED3h6E6nJ2xbRnkEaZbRSDKKqXpvRr1DQ","dq":"GbFD-FJUvn7iBwCI1_C_sUP2hgjDKmIe7zzXnrRNC22afXuExyMpHr69C033lFnPcWhsNDaQ-pCQp_n4gOLeNmOx9rSfrtN-4v22ID9ioEKpXEQKoBG-igyiq3BVJKLhr8MZSi1O3WiF7TqRBpOo2HtEnW9IRwdJ7iHGmaBb-A5blFt8DXOzNYbCZj7aMJPibCRxcUh77O0_RztjAQWsMW6PHU8fne8y0ZEFRvB6_miUjqin5X8zvhPv-ryqMFEOetoKZ1S1hPmEnH5OnmDya8DIkFMTHfPO9zuM4Q0ukKoYI0TQl8-wSLTRKoUBSeybr-4Uhb_0ActASwQyAYLy7Q","e":"AQAB","kty":"RSA","n":"i6iwUGb6MNFZrStP-5kfzH7JojT4dvzdh-jEZy0NYsIZwYqcHKdxZedjkb9k1P-H9hAMSzBxVQR-QOwu5YvMpW_yMwmOQrJo9v_5qfaYtw52jWD1dsxXKV8Sjmzp4Cawlc1mNsK3y--nYSSFRdKOb-GqDBybPgV9HA4TIoXuh3m_F7c0nTPhHS0GzyAUlo-R4ytrpjZFWNPKJ7riUYCKrCGfGlYIzchmfdYGefxy6k5OD81S3dqVxyXDnIcdV4lNVGNJyg2p40KeoezE-Bvusq3kdF0eHOvTIRaGXfyVLEfadNUro7pnQWJ3Du9MuVmWZsd5l33rKhTUCfyQzT4aUdN6jvhV08tEvSkPIV5bLwdwVHnLT2npT6FZiq21VLD5l8CKWcpE7KXC6AAyTFHMFgU2NCPnpozvC5_6EBHMi8U0hGDNNRDUxYn_nT6nvIzhR23wV2DOxqyIkKJfTpv6vhdoDg41NKIc6I40ym11Acs3ffqtrDRn1BDtFVnewyYQeneg-xQXjTxpP0fBjvNP7tu3Fu_fYghUUwEFIgClMJOLyNx9jW3FQsd95zBn5mHaGlMFzlInhqP2clMvoYK-4LZw2FRd9Ds1Qpjno-M-4b07-fkgXjOFMqVaKNDVmMIexsUl6s7SnuvXJzxRPx1F9W4O_xSzPodnyBbGTeZ9HbE","p":"5FI_UZ3-UivRchvNJPZFZOJOzOIpndlwpQcG2qDGSUFPOlazhi3EDy2Bev6-m2J9l174nWhKs_iJELFgF9PYlRKSHAd6fJ4lKauqWtSEVo9kWZFTxSgZrPER483cf6q5nMsMq6bgJ43KaGaKNRG3xagZKqXbxG4xrXXEkOykbHrVJ0XNQiKZeUNuI-gdYGRENKdnErcJGEENWPRBHceflxIGBGTHud6-crijYjAVtVAxDIp-51Kektxpj8qu9XH0L9NfXALvdGsH5teaXQ_wOouIdgRniLAFpADAGieN0oh0KIwKb3rzZHaV4yeoUTtI1hwgoGNV8SNskurpbQghVQ","q":"nJbh-BpnZBnRz6MNdmJQwTZAeFpOTkLuDs2GbdhUv2Dq6KUuaoMvNSiJ8MmS3_byxLFa72y1cEnIu3lDFelckaaiwZ1ybbttmLz2HnYzRcMjtZBpnKMYNQXlxB_qZ_F8N9KyKBsR5XbOc3opTyDE15oJHHKBnUjZcTJesPVxmDU5dszM3EJj-OeYgn5tW3IVqlB1dXCQ4JQWGsZ2niTuJaIqIsOrpu61w2H8trEHkW3AOdVBWs2tUunKBWVSd9P5tnKjZf5CLUIyweiZnv-pdAqsV_uzjizsJUtmgTo_UuORwcpVxNJdGJJREmg5TXFWXKcK-Jt0uKG_ugSkmMU67Q","qi":"2BQqgjPmZi71M4FZZVDswz1jo9fztYLfZPVxgXQ4GGMV_-xjx13gIWdhyRFZ1MUZTWDovLftX4djvDH0bQnQ3nmx876hl-TQMQQo_qF2L7FEzC1ZvCdMJdBJuneTkH5DKPK7-VHKEsmyul1b4MvyhS_47MSksmf9jtgwlwQY1H7KkbDUut0YP0D93U9X3vXLy0prYA-TCLitbHP0cUib2ZRd-Ulrc0QhG520TJMHP7S7VcanskWZnocfaogEL_jMVU9IVkfnQZvdxHUpI8pUKM_hRLNOmj4dc54v014To3RJ4zUEVWN5mRkTem4e5ON1lRH9vOtnitS5_RzvugoB9A"}'

# Run the Flutter drive command with the necessary parameters
flutter drive \
    --driver=test_driver/integration_test.dart \
    --target=integration_test/app_test.dart \
    -d web-server \
    --browser-name safari \
    --no-headless \
    --verbose \
    --dart-define=integration-test=true \
    --dart-define=WALLET_KEY_FILE="$JSON_VALUE"

"use strict";let retryStatusCodes=[408,429,440,460,499,500,502,503,504,520,521,522,523,524,525,527,598,599];const isStatusCodeError=e=>e>=400&&e<=599,retryDelay=(e,t)=>t*Math.pow(1.5,e),logMessage=(e,t,s,n)=>`uri: ${e}
  response: Http status error [${t}]: ${s}
  retryAttempts: ${n}`,logger={retry:(e,t,s,n)=>{const o=logMessage(e,t,s,n);console.warn(`Network Request Retry
${o}`)},error:(e,t,s,n)=>{const o=logMessage(e,t,s,n);console.error(`Network Request Error
${o}`)}},requestType={json:{contentType:"application/json; charset=utf-8",getResponse:async e=>await e.json()},bytes:{contentType:"application/octet-stream",getResponse:async e=>await e.arrayBuffer()},text:{contentType:"plain/text; charset=utf-8",getResponse:async e=>await e.text()}},get=async([e,t,s,n,o=!1,i=0])=>{try{const u=await fetch(e,{method:"GET",redirect:"follow",signal:AbortSignal.timeout(8e3)}),r=u.status,a=u.statusText;if(s>0&&retryStatusCodes.includes(r))return o||logger.retry(e,r,a,i),await get([e,t,s-1,n,o,i+1]);if(isStatusCodeError(r))return{error:`Network Request Error
${logMessage(e,r,a,i)}`,retryAttempts:i};const c=await requestType[`${t}`].getResponse(u);return{statusCode:r,statusMessage:a,data:c,retryAttempts:i}}catch(u){return{error:`${u}`,retryAttempts:i}}},post=async([e,t,s,n,o,i,u=!1,r=0])=>{try{const a=await fetch(e,{method:"POST",headers:{...s!==requestType.text.contentType?{"Content-Type":s}:{}},redirect:"follow",body:t,signal:AbortSignal.timeout(8e3)}),c=a.status,p=a.statusText;if(o>0&&retryStatusCodes.includes(c))return u||logger.retry(e,c,p,r),await post([e,t,s,n,o-1,i,u,r+1]);if(isStatusCodeError(c))return{error:`Network Request Error
${logMessage(e,c,p,r)}`,retryAttempts:r};const g=await requestType[`${n}`].getResponse(a);return{statusCode:c,statusMessage:p,data:g,retryAttempts:r}}catch(a){return{error:`${a}`,retryAttempts:r}}};self.get=get,self.post=post;
